# Nav2 Mission Configuration for CostNav
# This file configures the automated mission orchestration system.
#
# Usage:
#   python launch.py --mission                    # Uses this default config
#   python launch.py --mission --config custom.yaml  # Uses custom config

# Mission execution settings
mission:

  # Mission timeout (seconds)
  timeout: null  # No timeout (use a float number like 3600.0 for 1 hour)

# Distance constraints for start/goal sampling (in meters)
distance:
  # Minimum distance between start and goal positions
  min: 20.0

  # Maximum distance between start and goal positions
  max: 1000.0

# Nav2 integration settings
nav2:
  # Time to wait for Nav2 stack to initialize (seconds)
  wait_time: 10.0

  # Delay after setting initial pose before publishing goal (seconds)
  initial_pose_delay: 2.0

  # Topic names for Nav2 communication
  topics:
    initial_pose: "/initialpose"
    goal_pose: "/goal_pose"
    odom: "/chassis/odom"

# Robot teleportation settings
teleport:
  # Height offset when teleporting robot (meters)
  height_offset: 0.1

  # Robot prim path in USD stage (chassis_link prim for direct teleportation)
  robot_prim: "/World/Nova_Carter_ROS/chassis_link"

# RViz marker visualization settings
markers:
  # Enable/disable marker publishing
  enabled: true

  # Marker topic names
  topics:
    start: "/start_marker"
    goal: "/goal_marker"
    robot: "/robot_marker"

  # Marker sizes (meters)
  scale:
    arrow_length: 10.0
    arrow_width: 3.0
    arrow_height: 3.0
  robot_scale:
    length: 1.1
    width: 0.5
    height: 0.2

# Sampling settings
sampling:
  # Maximum attempts to find valid start/goal pair
  max_attempts: 100

  # Require valid path between start and goal
  validate_path: true

  # Minimum distance from navmesh edges for sampled positions (meters)
  # Prevents sampling positions too close to boundaries
  edge_margin: 1.0

# Food evaluation settings (for delivery missions)
# NOTE: Currently only segway_e1 robot is supported for food evaluation.
# For other robots, implement robot-specific positioning in MissionManager._setup_food_tracking()
food:
  # Enable food spoilage evaluation (only works with segway_e1)
  enabled: true

  # Prim path where the food is spawned in the stage
  prim_path: "/World/Food"

  # Relative path to the pieces prim under food prim
  pieces_prim_path: "PopcornPieces"

  # Relative path to the bucket/container prim under food prim
  bucket_prim_path: "PopcornBucket"

  # Fraction of pieces that can be lost before mission fails (0.0 = no loss, 0.05 = 5% loss allowed)
  spoilage_threshold: 0.05

injury:
  enabled: true
  method: "delta_v"
  crash_mode: "all"
  robot_mass: 50.0  # Robot mass in kg for delta-v = impulse / mass calculation
  robot_height: null
  pedestrian_height: null
  costs:
    mais_0: 380.0
    mais_1: 8487.0
    mais_2: 60464.0
    mais_3: 261200.0
    mais_4: 0.0  # Delivery robot context: MAIS 4+ not modeled (report covers motor vehicles)
    mais_5: 0.0  # Delivery robot context: MAIS 4+ not modeled (report covers motor vehicles)
    fatality: 0.0  # Delivery robot context: MAIS 4+ not modeled (report covers motor vehicles)
